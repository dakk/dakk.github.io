---
layout: post
title: Dices provably fair - Nonce overflow vulnerability
date: 
type: post
published: false
status: private
categories:
- BitCoin
- Bugs
- Vulnerability
tags: []
meta:
  _edit_last: '422218'
  _publicize_pending: '1'
  _wpas_skip_facebook: '1'
  geo_public: '0'
  _wpas_skip_google_plus: '1'
  _wpas_skip_twitter: '1'
  _wpas_skip_linkedin: '1'
  _wpas_skip_tumblr: '1'
  _wpas_skip_path: '1'
author:
  login: dagide
  email: gessadavide@gmail.com
  display_name: davide
  first_name: ''
  last_name: ''
---
<p>Most of bitcoin dice software use a system to prove the fair play of the server for each bet. Most of them implement this mechanism using two seed (server seed and client seed) combined with a session nonce in the aim to provide a fair random number for each bet and usually this nonce is initialized to 0 after each seed change.</p>
<p>But, what if this nonce is stored in an unsigned integer variable (32bit in 32bit systems, 2³² values)? Theorically after 2³²-1 bets, the nonce goes in overflow and return to 0.</p>
<p>Saving each bet roll for every play in the first 2³²-1 window, will provide a map function:</p>
<p style="text-align:center;"><em style="text-align:center;">f: n → roll . (n &lt; 2³²)</em></p>
<p style="text-align:left;">that could be used to declare a function <em>g(m)</em> that predicts every future roll:</p>
<p style="text-align:center;"><em>g (m) = f (m % 2³²)</em></p>
<p style="text-align:left;">A simple fix for this problem is to regenerate the server seed and reset the nonce after 2³² bets.</p>
